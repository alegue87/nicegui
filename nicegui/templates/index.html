<!DOCTYPE html>
<html>
  <head>
    <title>{{ title }}</title>
    <meta name="viewport" content="{{ viewport }}" />
    <link href="{{ favicon_url }}" rel="shortcut icon" />
    <link href="{{ prefix | safe }}/_nicegui/{{version}}/static/nicegui.css" rel="stylesheet" type="text/css" />
    <link href="{{ prefix | safe }}/_nicegui/{{version}}/static/fonts.css" rel="stylesheet" type="text/css" />

    {% if prod_js %}<!-- TODO switch ui components -->
    <link href="{{ prefix | safe }}/_nicegui/{{version}}/static/quasar.prod.css" rel="stylesheet" type="text/css" />

    <link href="{{ prefix | safe }}/_nicegui/{{version}}/static/vuetify.min.css" rel="stylesheet" type="text/css" />
    <!-- Vuetify icons default -->
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@5.x/css/materialdesignicons.min.css" rel="stylesheet">

    <link href="{{ prefix | safe }}/_nicegui/{{version}}/static/element.min.css" rel="stylesheet">
    <!--link href="{{ prefix | safe }}/_nicegui/{{version}}/static/antd.min.css" rel="stylesheet" type="text/css" /-->


    {% else %}
    <link href="{{ prefix | safe }}/_nicegui/{{version}}/static/quasar.css" rel="stylesheet" type="text/css" />

    <link href="{{ prefix | safe }}/_nicegui/{{version}}/static/vuetify.min.css" rel="stylesheet" type="text/css" />
    <!-- Vuetify icons default -->
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@5.x/css/materialdesignicons.min.css" rel="stylesheet">

    <link href="{{ prefix | safe }}/_nicegui/{{version}}/static/element.min.css" rel="stylesheet">
    <!--link href="{{ prefix | safe }}/_nicegui/{{version}}/static/antd.min.css" rel="stylesheet" type="text/css" /-->


    {% endif %}
    <!-- prevent Prettier from removing this line -->
    {{ head_html | safe }}
  </head>
  <body>
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/es-module-shims.js"></script>
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/socket.io.min.js"></script>
    <!-- Modern JavaScript date utility library -->
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/data-fns.min.js"></script>

    {% if tailwind %}
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/tailwindcss.min.js"></script>
    {% endif %}
    <!-- prevent Prettier from removing this line -->
    {% if prod_js %}
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/vue.global.prod.js"></script>

      {% if ui_components_suite == 'quasar' %}
      <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/quasar.umd.prod.js"></script>

      {% elif ui_components_suite == 'naive' %}
      <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/naive-ui.js"></script>

      {% elif ui_components_suite == 'primevue' %}
      <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/primevue.min.js"></script>
      <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/aura.min.js"></script>

      {% elif ui_components_suite == 'vuetify' %}
      <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/vuetify.min.js"></script>

      {% elif ui_components_suite == 'element' %}
      <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/element.full.min.js"></script>
      <!-- Ant broke the import of mermaid or other depencencies
      <script type="module" src="{{ prefix | safe }}/_nicegui/{{version}}/static/antd.min.js"></script>
      <script src="https://unpkg.com/dayjs/dayjs.min.js"></script>
      <script src="https://unpkg.com/dayjs/plugin/customParseFormat.js"></script>
      <script src="https://unpkg.com/dayjs/plugin/weekday.js"></script>
      <script src="https://unpkg.com/dayjs/plugin/localeData.js"></script>
      <script src="https://unpkg.com/dayjs/plugin/weekOfYear.js"></script>
      <script src="https://unpkg.com/dayjs/plugin/weekYear.js"></script>
      <script src="https://unpkg.com/dayjs/plugin/advancedFormat.js"></script>
      <script src="https://unpkg.com/dayjs/plugin/quarterOfYear.js"></script>
      -->
      {% endif %}
    {% else %}
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/vue.global.js"></script>
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/quasar.umd.js"></script>
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/naive-ui.js"></script>
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/primevue.min.js"></script>
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/aura.min.js"></script>
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/vuetify.min.js"></script>
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/element.full.min.js"></script>
    <!--
    <script type="module" src="{{ prefix | safe }}/_nicegui/{{version}}/static/antd.min.js"></script>
    <script src="https://unpkg.com/dayjs/dayjs.min.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/customParseFormat.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/weekday.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/localeData.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/weekOfYear.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/weekYear.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/advancedFormat.js"></script>
    <script src="https://unpkg.com/dayjs/plugin/quarterOfYear.js"></script>
    -->

    {% endif %}
    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/nicegui.js"></script>

    <script src="{{ prefix | safe }}/_nicegui/{{version}}/static/lang/{{ language }}.umd.prod.js"></script>
    <script type="importmap">
      {"imports": {{ imports | safe }}}
    </script>
    {{ body_html | safe }}

    <div id="app"></div>
    <div id="popup" aria-hidden="true">
      <span>Connection lost.</span>
      <span>Trying to reconnect...</span>
    </div>
    <script type="module">
      const app = createApp(parseElements(String.raw`{{ elements | safe }}`), {
        version: "{{ version }}",
        prefix: "{{ prefix | safe }}",
        query: {{ socket_io_js_query_params | safe }},
        extraHeaders: {{ socket_io_js_extra_headers | safe }},
        transports: {{ socket_io_js_transports | safe }},

      });

      {% if prod_js %}

        {% if ui_components_suite == 'quasar' %}
        app.use(Quasar, {config: {{ quasar_config | safe }}})

        {% elif ui_components_suite == 'naive' %}
        app.use(naive)

        {% elif ui_components_suite == 'vuetify' %}
        app.use(Vuetify.createVuetify())

        {% elif ui_components_suite == 'element' %}
        app.use(ElementPlus)

        {% elif ui_components_suite == 'primevue' %}
        app.use(PrimeVue.Config, { theme: { preset: PrimeVue.Themes.Aura } } )
          .component('p-button', PrimeVue.Button)
          .component('p-date', PrimeVue.DatePicker)
        {% endif %}

      {% else %}
        app.use(Quasar, {config: {{ quasar_config | safe }}})
          .use(naive)
          .use(Vuetify.createVuetify())
          .use(ElementPlus)
          //.use(antd)
          .use(PrimeVue.Config, { theme: { preset: PrimeVue.Themes.Aura } } )
          .component('p-button', PrimeVue.Button)
          .component('p-date', PrimeVue.DatePicker)
      {% endif %}

      app.$refs = Object // is necessary?

      {{ js_imports | safe }}
      {{ vue_scripts | safe }}

      const dark = {{ dark }};
      {% if prod_js or ui_components_suite == 'quasar' %}
      Quasar.lang.set(Quasar.lang["{{ language }}".replace('-', '')]);
      Quasar.Dark.set(dark === None ? "auto" : dark);
      {% endif %}

      {% if tailwind %}
      if (dark !== None) tailwind.config.darkMode = "class";
      if (dark === True) document.body.classList.add("dark");
      {% endif %}

      app.mount("#app");
    </script>
  </body>
</html>
